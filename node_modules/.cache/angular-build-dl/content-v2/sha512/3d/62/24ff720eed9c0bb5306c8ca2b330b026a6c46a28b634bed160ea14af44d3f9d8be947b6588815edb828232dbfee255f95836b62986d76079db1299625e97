{"version":3,"sources":["webpack:///src/app/subscription-page/subscription-page.page.html","webpack:///src/app/razorpay.service.ts","webpack:///src/app/subscription-page/subscription-page-routing.module.ts","webpack:///src/app/subscription-page/subscription-page.module.ts","webpack:///src/app/subscription-page/subscription-page.page.scss","webpack:///src/app/subscription-page/subscription-page.page.ts"],"names":["RazorpayService","http","loadingCtrl","url","data","headers","append","options","create","load","present","Promise","resolve","reject","post","pipe","dismiss","subscribe","res","err","get","providedIn","routes","path","component","SubscriptionPagePageRoutingModule","imports","forChild","exports","SubscriptionPagePageModule","declarations","SubscriptionPagePage","route","router","authService","iab","razorpayService","swStorage","loginAuth","planList","subscriptionObj","addons","notes","roomname","rooms","ref","autoRefreshFire","familyMember","LOGINUSER_PROFILE","randomString","Math","random","toString","substring","console","log","myRand","snapshot","getStorage","then","ptdata","ptDetail","verifyfamilymember","userID","docProfileList","circleDetail","circledetail","getRazorpayPlanList","userid","checkFamilyMember","getSubscribPlanList","getRazorpaySubscribPlanList","rzPlanList","amount","amt","substr","plan_id","planDetails","checkPatientSubscribedInCircle","circleObj","circleCode","alert","navigateByUrl","Date","getTime","planName","name","expireDate","addonItem","item","currency","subscriptionPlanDetails","plandetails","subscriptionfromdate","subscriptionexpirydate","total_count","quantity","customer_notify","notes_key_1","notes_key_2","createRazorpaySubscribe","pay","subscriptionType","userType","updateCirclePatientAccountType","patientdetail","removeStorage","setStorage","addCircleObj","createdDateTime","subscribePlanId","status","createPtChatObj","circleName","docUserID","createdByUserId","patientUserID","patientName","ptFirstName","ptLastName","createdByDateTime","videoCallLink","dl","doctorName","docFirstName","docLastName","chatRoomName","newData","push","set","currentroomKey","key","setTimeout","undefined","addPtToCircle","chatRoomKey","createPtChat","data1","chatRestrictSubscribeObj","subscriptionId","id","subscriptionFromDate","subscriptionToDate","paymentId","chatCount","createChatRestriction","subscriptionData","description","subscription_id","paymentCapture","bind","prefill","email","contact","theme","color","modal","ondismiss","successCallback","payment_id","cancelCallback","error","code","Razorpay","open","response","razorpay_payment_id","rand","floor","logout","selector","template","snapshotToArray","returnArr","forEach","childSnapshot","val"],"mappings":"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","file":"subscription-page-subscription-page-module-es5.js","sourcesContent":["export default \"<ion-header [translucent]=\\\"true\\\">\\r\\n  <ion-toolbar>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-back-button></ion-back-button>\\r\\n      <img src=\\\"{{authService.logo_url}}\\\" height=\\\"24\\\" style=\\\"vertical-align: middle; padding-left: 15px;\\\">\\r\\n      <ion-title>Swasth</ion-title>\\r\\n    </ion-buttons>\\r\\n    <ion-buttons slot=\\\"end\\\">\\r\\n      <ion-icon name=\\\"exit-outline\\\" style=\\\"font-size: 26px;\\\" (click)=\\\"logout()\\\"></ion-icon>\\r\\n    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <ion-row>\\r\\n    <ion-col class=\\\"regis__heading\\\">\\r\\n      <h1>Become a Premium</h1>\\r\\n      <p>Get access to health locker and other swasth features with premium subscription</p>\\r\\n    </ion-col>\\r\\n  </ion-row>\\r\\n  <ion-grid fixed *ngIf=\\\"ptDetail!=undefined\\\">\\r\\n    <ion-row style=\\\"margin-top: 10px;\\\" *ngIf=\\\"ptDetail.accountType=='Family'\\\">\\r\\n      <ion-col size=\\\"12\\\" sizeMd=\\\"6\\\" offsetMd=\\\"3\\\" *ngIf=\\\"rzPlanList!=undefined\\\">\\r\\n        <ion-card *ngFor=\\\"let pl of rzPlanList.items index as i\\\">\\r\\n          <ng-container *ngIf=\\\"i<2\\\">\\r\\n            <ion-card-content *ngIf=\\\"ptDetail.accountType=='Family' && pl.item.name=='Plan A'\\\">\\r\\n              <div style=\\\"width: 100%; display: flex;\\\">\\r\\n                <div style=\\\"width: 65%;\\\">\\r\\n                  <ion-card-subtitle>{{pl.item.name}}</ion-card-subtitle>\\r\\n                  <ion-card-title>₹ {{showAmount(pl.item.amount)}}/ {{pl.period}}</ion-card-title>\\r\\n                  <p>{{pl.item.description}}</p>\\r\\n                </div>\\r\\n                <div style=\\\"width: 35%; margin: auto;\\\">\\r\\n                  <ion-button (click)=\\\"createSubscripe(pl.id,pl.item)\\\">Subscribe</ion-button>\\r\\n                </div>\\r\\n              </div>\\r\\n            </ion-card-content>\\r\\n          </ng-container>\\r\\n        </ion-card>\\r\\n        <!-- <ion-card>\\r\\n          <ion-card-content>\\r\\n            <div style=\\\"width: 100%; display: flex;\\\">\\r\\n              <div style=\\\"width: 65%;\\\">\\r\\n                <ion-card-subtitle>Yearly</ion-card-subtitle>\\r\\n                <ion-card-title>₹ 80/ month</ion-card-title>\\r\\n                <p>Subscription Charged yearly - ₹960</p>\\r\\n              </div>\\r\\n              <div style=\\\"width: 35%; margin: auto;\\\">\\r\\n                <ion-button>Subscribe</ion-button>\\r\\n              </div>\\r\\n            </div>\\r\\n          </ion-card-content>\\r\\n        </ion-card> -->\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n    <ion-row style=\\\"margin-top: 10px;\\\" *ngIf=\\\"familyMember==true\\\">\\r\\n      <ion-col size=\\\"12\\\" sizeMd=\\\"6\\\" offsetMd=\\\"3\\\" *ngIf=\\\"rzPlanList!=undefined\\\">\\r\\n        <ion-card *ngFor=\\\"let pl of rzPlanList.items index as i\\\">\\r\\n          <ng-container *ngIf=\\\"i<2\\\">\\r\\n            <ion-card-content *ngIf=\\\"pl.item.name=='Plan A'\\\">\\r\\n              <div style=\\\"width: 100%; display: flex;\\\">\\r\\n                <div style=\\\"width: 65%;\\\">\\r\\n                  <ion-card-subtitle>{{pl.item.name}}</ion-card-subtitle>\\r\\n                  <ion-card-title>₹ {{showAmount(pl.item.amount)}}/ {{pl.period}}</ion-card-title>\\r\\n                  <p>{{pl.item.description}}</p>\\r\\n                </div>\\r\\n                <div style=\\\"width: 35%; margin: auto;\\\">\\r\\n                  <ion-button (click)=\\\"createSubscripe(pl.id,pl.item)\\\">Subscribe</ion-button>\\r\\n                </div>\\r\\n              </div>\\r\\n            </ion-card-content>\\r\\n          </ng-container>\\r\\n        </ion-card>\\r\\n        <!-- <ion-card>\\r\\n          <ion-card-content>\\r\\n            <div style=\\\"width: 100%; display: flex;\\\">\\r\\n              <div style=\\\"width: 65%;\\\">\\r\\n                <ion-card-subtitle>Yearly</ion-card-subtitle>\\r\\n                <ion-card-title>₹ 80/ month</ion-card-title>\\r\\n                <p>Subscription Charged yearly - ₹960</p>\\r\\n              </div>\\r\\n              <div style=\\\"width: 35%; margin: auto;\\\">\\r\\n                <ion-button>Subscribe</ion-button>\\r\\n              </div>\\r\\n            </div>\\r\\n          </ion-card-content>\\r\\n        </ion-card> -->\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n    <ion-row style=\\\"margin-top: 10px;\\\" *ngIf=\\\"ptDetail.accountType!='Family' && familyMember!=true\\\">\\r\\n      <ion-col size=\\\"12\\\" sizeMd=\\\"6\\\" offsetMd=\\\"3\\\" *ngIf=\\\"rzPlanList!=undefined\\\">\\r\\n        <ion-card *ngFor=\\\"let pl of rzPlanList.items index as i\\\">\\r\\n          <ng-container *ngIf=\\\"i<2\\\">\\r\\n            <ion-card-content>\\r\\n              <div style=\\\"width: 100%; display: flex;\\\">\\r\\n                <div style=\\\"width: 65%;\\\">\\r\\n                  <ion-card-subtitle>{{pl.item.name}}</ion-card-subtitle>\\r\\n                  <ion-card-title>₹ {{showAmount(pl.item.amount)}}/ {{pl.period}}</ion-card-title>\\r\\n                  <p>{{pl.item.description}}</p>\\r\\n                </div>\\r\\n                <div style=\\\"width: 35%; margin: auto;\\\">\\r\\n                  <ion-button (click)=\\\"createSubscripe(pl.id,pl.item)\\\">Subscribe</ion-button>\\r\\n                </div>\\r\\n              </div>\\r\\n            </ion-card-content>\\r\\n          </ng-container>\\r\\n        </ion-card>\\r\\n        <!-- <ion-card>\\r\\n          <ion-card-content>\\r\\n            <div style=\\\"width: 100%; display: flex;\\\">\\r\\n              <div style=\\\"width: 65%;\\\">\\r\\n                <ion-card-subtitle>Yearly</ion-card-subtitle>\\r\\n                <ion-card-title>₹ 80/ month</ion-card-title>\\r\\n                <p>Subscription Charged yearly - ₹960</p>\\r\\n              </div>\\r\\n              <div style=\\\"width: 35%; margin: auto;\\\">\\r\\n                <ion-button>Subscribe</ion-button>\\r\\n              </div>\\r\\n            </div>\\r\\n          </ion-card-content>\\r\\n        </ion-card> -->\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n\\r\\n    <ion-row>\\r\\n      <ion-col>\\r\\n        <p style=\\\"font-weight: bold; padding-left: 10px; text-decoration: underline; color: #222222;\\\">Terms &\\r\\n          Conditions:</p>\\r\\n        <p\\r\\n          style=\\\"color: #737373;font-weight: 100; text-indent: 40px; padding-left: 10px; padding-right: 10px; word-break: break-all; font-size: 14px;\\\">\\r\\n          ddada dada da da da da da da d dsa das da d ad ad sad sad ad ad ad ad sadas da da da da da dada dsada.</p>\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n  </ion-grid>\\r\\n</ion-content>\";","import { Injectable } from '@angular/core';\r\nimport { Http, Headers, RequestOptions } from '@angular/http';\r\n// import 'rxjs/add/operator/map';\r\nimport { LoadingController } from '@ionic/angular';\r\nimport { finalize } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class RazorpayService {\r\n\r\n  data;\r\n\r\n  constructor(public http: Http,public loadingCtrl: LoadingController) { }\r\n\r\n  async callPost(url,data) {\r\n    var headers = new Headers();\r\n    headers.append('Content-Type', 'application/x-www-form-urlencoded');\r\n    let options = new RequestOptions({ headers: headers });\r\n\r\n    const load=await this.loadingCtrl.create({});\r\n    load.present();\r\n\r\n    return new Promise((resolve,reject) => {\r\n      this.http.post(\"http://api.razorpay.com/\"+ url,data)\r\n      .pipe(finalize(()=>load.dismiss()))\r\n      .subscribe((res) => {\r\n          resolve(res);  \r\n      },(err)=>{\r\n        reject(err);\r\n      })\r\n    });\r\n  }\r\n\r\n  async callGet(url){\r\n    var headers = new Headers();\r\n    headers.append('Content-Type', 'application/x-www-form-urlencoded');\r\n    let options = new RequestOptions({ headers: headers });\r\n\r\n    let load = await this.loadingCtrl.create({});\r\n    load.present();\r\n\r\n    return new Promise((resolve,reject) => {\r\n      this.http.get(\"http://api.razorpay.com/\"+ url)\r\n      .pipe(finalize(()=>load.dismiss()))\r\n      .subscribe((res) => {\r\n          resolve(res);  \r\n      },(err)=>{\r\n        reject(err);\r\n      })\r\n    });\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { SubscriptionPagePage } from './subscription-page.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SubscriptionPagePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class SubscriptionPagePageRoutingModule {}\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { SubscriptionPagePageRoutingModule } from './subscription-page-routing.module';\r\n\r\nimport { SubscriptionPagePage } from './subscription-page.page';\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    SubscriptionPagePageRoutingModule\r\n  ],\r\n  declarations: [SubscriptionPagePage]\r\n})\r\nexport class SubscriptionPagePageModule {}\r\n","export default \".regis__heading {\\n  height: 180px;\\n  padding-top: 50px;\\n  background-image: linear-gradient(120deg, #0059b3, #00b395);\\n}\\n.regis__heading h1 {\\n  text-align: center;\\n  color: #fff;\\n  text-shadow: 1px 1px 5px #222222;\\n}\\n.regis__heading p {\\n  text-align: center;\\n  color: #fff;\\n}\\nion-button {\\n  --border-radius: 30px;\\n  --background: #00b395;\\n}\\nion-card {\\n  --background:aliceblue;\\n  border-radius: 10px;\\n}\\nion-card ion-card-title {\\n  color: #0059b3;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvc3Vic2NyaXB0aW9uLXBhZ2UvRjpcXHN3YXN0aFxcc3dhc3RodmlydHVhbHBhdGllbnQvc3JjXFxhcHBcXHN1YnNjcmlwdGlvbi1wYWdlXFxzdWJzY3JpcHRpb24tcGFnZS5wYWdlLnNjc3MiLCJzcmMvYXBwL3N1YnNjcmlwdGlvbi1wYWdlL3N1YnNjcmlwdGlvbi1wYWdlLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDSTtFQUNJLGFBQUE7RUFDQSxpQkFBQTtFQUNBLDJEQUFBO0FDQVI7QURDUTtFQUNJLGtCQUFBO0VBQ0EsV0FBQTtFQUNBLGdDQUFBO0FDQ1o7QURDUTtFQUNJLGtCQUFBO0VBQ0EsV0FBQTtBQ0NaO0FER0E7RUFDSSxxQkFBQTtFQUNBLHFCQUFBO0FDQUo7QURFQTtFQUNJLHNCQUFBO0VBQ0EsbUJBQUE7QUNDSjtBREFJO0VBQ0ksY0FBQTtBQ0VSIiwiZmlsZSI6InNyYy9hcHAvc3Vic2NyaXB0aW9uLXBhZ2Uvc3Vic2NyaXB0aW9uLXBhZ2UucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnJlZ2lze1xyXG4gICAgJl9faGVhZGluZyB7XHJcbiAgICAgICAgaGVpZ2h0OiAxODBweDtcclxuICAgICAgICBwYWRkaW5nLXRvcDogNTBweDtcclxuICAgICAgICBiYWNrZ3JvdW5kLWltYWdlOiBsaW5lYXItZ3JhZGllbnQoMTIwZGVnLCAjMDA1OWIzLCAjMDBiMzk1KTtcclxuICAgICAgICBoMSB7XHJcbiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgICAgICAgICAgY29sb3I6ICNmZmY7XHJcbiAgICAgICAgICAgIHRleHQtc2hhZG93OiAxcHggMXB4IDVweCAjMjIyMjIyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBwIHtcclxuICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgICAgICAgICBjb2xvcjogI2ZmZjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuaW9uLWJ1dHRvbiB7XHJcbiAgICAtLWJvcmRlci1yYWRpdXM6IDMwcHg7XHJcbiAgICAtLWJhY2tncm91bmQ6ICMwMGIzOTU7XHJcbn1cclxuaW9uLWNhcmQge1xyXG4gICAgLS1iYWNrZ3JvdW5kOmFsaWNlYmx1ZTtcclxuICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7XHJcbiAgICBpb24tY2FyZC10aXRsZSB7XHJcbiAgICAgICAgY29sb3I6ICMwMDU5YjM7XHJcbiAgICB9XHJcbn0iLCIucmVnaXNfX2hlYWRpbmcge1xuICBoZWlnaHQ6IDE4MHB4O1xuICBwYWRkaW5nLXRvcDogNTBweDtcbiAgYmFja2dyb3VuZC1pbWFnZTogbGluZWFyLWdyYWRpZW50KDEyMGRlZywgIzAwNTliMywgIzAwYjM5NSk7XG59XG4ucmVnaXNfX2hlYWRpbmcgaDEge1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gIGNvbG9yOiAjZmZmO1xuICB0ZXh0LXNoYWRvdzogMXB4IDFweCA1cHggIzIyMjIyMjtcbn1cbi5yZWdpc19faGVhZGluZyBwIHtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBjb2xvcjogI2ZmZjtcbn1cblxuaW9uLWJ1dHRvbiB7XG4gIC0tYm9yZGVyLXJhZGl1czogMzBweDtcbiAgLS1iYWNrZ3JvdW5kOiAjMDBiMzk1O1xufVxuXG5pb24tY2FyZCB7XG4gIC0tYmFja2dyb3VuZDphbGljZWJsdWU7XG4gIGJvcmRlci1yYWRpdXM6IDEwcHg7XG59XG5pb24tY2FyZCBpb24tY2FyZC10aXRsZSB7XG4gIGNvbG9yOiAjMDA1OWIzO1xufSJdfQ== */\";","import { Component, OnInit } from '@angular/core';\r\nimport { Router, ActivatedRoute } from '@angular/router';\r\nimport { AuthService } from '../auth.service';\r\nimport { InAppBrowser } from '@ionic-native/in-app-browser/ngx';\r\nimport { RazorpayService } from '../razorpay.service';\r\nimport * as firebase from 'Firebase';\r\nimport { SwasthStorageService } from '../storage/swasth-storage.service';\r\nimport { LoginAuthService } from '../services/login-auth.service';\r\n\r\n@Component({\r\n  selector: 'app-subscription-page',\r\n  templateUrl: './subscription-page.page.html',\r\n  styleUrls: ['./subscription-page.page.scss'],\r\n})\r\nexport class SubscriptionPagePage implements OnInit {\r\n  paymentId: any;\r\n\r\n  planList: any = [];\r\n  rzPlanList: any;\r\n  circleObj: any;\r\n  subscribeResp: any;\r\n  docProfileList: any;\r\n  circleDetail: any;\r\n  ptDetail: any;\r\n\r\n  subscriptionPlanDetails\r\n  subscriptionObj: any = {\r\n    addons: [],\r\n    notes: {}\r\n  }\r\n  data = { roomname: '' };\r\n  rooms = [];\r\n  ref = firebase.database().ref('chatrooms/');\r\n  autoRefreshFire = firebase.database().ref('autorefresh/circlepatient');\r\n  currentroomKey: any;\r\n  chatRoomName: any;\r\n  myRand: any;\r\n  subscriptionType: any;\r\n\r\n  randomString: any;\r\n  url: string;\r\n  planName: any;\r\n  accountType: any;\r\n  userType: any;\r\n  familyMember = false;\r\n  LOGINUSER_PROFILE = \"patient_profile\";\r\n  //autoRefreshFire = firebase.database().ref('autorefresh/circlepatient');\r\n  constructor(private route: ActivatedRoute, private router: Router, private readonly authService: AuthService,\r\n    private iab: InAppBrowser, private razorpayService: RazorpayService, private swStorage: SwasthStorageService,\r\n    private loginAuth: LoginAuthService) {\r\n    /* if (this.router.getCurrentNavigation().extras.state) {\r\n      this.docProfileList = this.router.getCurrentNavigation().extras.state.docProfileList;\r\n      this.circleDetail = this.router.getCurrentNavigation().extras.state.circledetail;\r\n      this.ptDetail = this.router.getCurrentNavigation().extras.state.ptdetail;\r\n    } */\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.randomString = Math.random().toString(36).substring(7);\r\n    console.log(\"Random String==>\", this.randomString);\r\n    this.url = \"https://meet.jit.si/\" + this.randomString;\r\n    //this.urlSafe= this.sanitizer.bypassSecurityTrustResourceUrl(this.url);\r\n    this.myRand = this.random();\r\n    /* this.route.queryParams.subscribe(params => {\r\n      if (this.router.getCurrentNavigation().extras.state) {\r\n        this.circleObj = this.router.getCurrentNavigation().extras.state.circleObj;\r\n      }\r\n    }); */\r\n    if (this.route.snapshot.data['sbData']) {\r\n      let data = this.route.snapshot.data['sbData'];\r\n      this.swStorage.getStorage(this.loginAuth.LOGINUSER_PROFILE).then(ptdata => {\r\n        this.ptDetail = ptdata;\r\n        console.log(\"Patient Details===>\", this.ptDetail);\r\n        this.verifyfamilymember(this.ptDetail.userID);\r\n        this.docProfileList = data.docProfileList;\r\n        this.circleDetail = data.circledetail;\r\n      });\r\n    }\r\n\r\n    this.getRazorpayPlanList();\r\n\r\n  }\r\n\r\n  // verify family member\r\n  verifyfamilymember(userid) {\r\n    this.authService\r\n      .checkFamilyMember(userid)\r\n      .subscribe(data => {\r\n        console.log(\"Family Verify==>\", data);\r\n        if (data == \"1\") {\r\n          //alert(\"true\");\r\n          this.familyMember = true;\r\n          console.log(\"Family Member Status==>\", this.familyMember);\r\n        }\r\n        else {\r\n          //alert(\"false\");\r\n          this.familyMember = false;\r\n        }\r\n      });\r\n\r\n  }\r\n\r\n  // get swasth subscribe plan list\r\n  getPlanList() {\r\n    this.authService.getSubscribPlanList()\r\n      .subscribe(data => {\r\n        console.log(\"response res--\", data);\r\n        this.planList = data;\r\n      });\r\n  }\r\n\r\n  // get razorpay subscribe plan list\r\n  getRazorpayPlanList() {\r\n    this.authService.getRazorpaySubscribPlanList()\r\n      .subscribe(data => {\r\n        console.log(\"response res--\", data);\r\n        this.rzPlanList = data;\r\n      });\r\n  }\r\n\r\n  showAmount(amount: any) {\r\n    console.log(\"amount\", amount);\r\n    let amt = amount.toString();\r\n    return amt.substr(0, 3);\r\n  }\r\n\r\n  circlepage() {\r\n    console.log(\"asdada\");\r\n    // this.router.navigate(['/login']);\r\n  }\r\n  createSubscripe(plan_id, planDetails) {\r\n    this.authService\r\n      .checkPatientSubscribedInCircle(this.ptDetail.userID, this.circleDetail.circleObj.circleCode)\r\n      .subscribe(data => {\r\n        if (data == \"1\") {\r\n          alert(\"Already you joined this circle\");\r\n          this.router.navigateByUrl('subscribed-doctor-circle');\r\n        }\r\n        else {\r\n          console.log(\"Current Time==>\", new Date().getTime());\r\n          console.log(\"Plan ID==>\", plan_id);\r\n          this.planName = planDetails.name;\r\n          //alert(this.planName);\r\n          // let dateObj=new Date();\r\n          // dateObj.setTime(dateObj.getDate()+30);\r\n          let expireDate = new Date((new Date()).getTime() + 30 * 24 * 60 * 60 * 1000);\r\n          console.log(\"Expire Time==>\", expireDate.getTime());\r\n          let addonItem: any = {\r\n            item: {\r\n              name: planDetails.name,\r\n              amount: planDetails.amount,\r\n              currency: \"INR\"\r\n            }\r\n          }\r\n          this.subscriptionPlanDetails = {\r\n            plandetails: planDetails,\r\n            subscriptionfromdate: new Date(),\r\n            subscriptionexpirydate: expireDate,\r\n          }\r\n          console.log(\"Plan Details==>\", planDetails);\r\n          this.subscriptionObj.plan_id = plan_id;\r\n          this.subscriptionObj.total_count = 1;\r\n          this.subscriptionObj.quantity = 1;\r\n          // this.subscriptionObj.start_at=new Date().getTime();\r\n          // this.subscriptionObj.expire_by=expireDate.getTime();\r\n          this.subscriptionObj.customer_notify = 1;\r\n          //this.subscriptionObj.addons.push(addonItem);\r\n          this.subscriptionObj.notes.notes_key_1 = \"\";\r\n          this.subscriptionObj.notes.notes_key_2 = \"\";\r\n          console.log(\"Subscription Object==>\", this.subscriptionObj);\r\n          this.authService\r\n            .createRazorpaySubscribe(this.subscriptionObj)\r\n            .subscribe(data => {\r\n              console.log(\"data\", data);\r\n              if (data != null) {\r\n                this.pay(data);\r\n              }\r\n            });\r\n        }\r\n      })\r\n\r\n  }\r\n\r\n  subscribe() {\r\n    console.log(\"circle detail\", this.circleDetail, this.docProfileList, this.ptDetail);\r\n    //console.log(\"plan name==>\",plan_name);\r\n\r\n\r\n\r\n    if (this.planName == \"Plan A\") {\r\n      //alert(\"Normal\");  \r\n      this.subscriptionType = \"Normal\";\r\n      this.userType = \"Secondary\";\r\n      this.authService\r\n        .updateCirclePatientAccountType(this.ptDetail.userID, \"Normal\")\r\n        .subscribe(data => {\r\n          console.log(\"Upadte Status==>\", data);\r\n          this.authService\r\n          .patientdetail(this.ptDetail.userID)\r\n          .subscribe(data=>{\r\n            this.swStorage.removeStorage(this.LOGINUSER_PROFILE);\r\n            this.swStorage.setStorage(this.LOGINUSER_PROFILE, data);\r\n          })\r\n        });\r\n    }\r\n    else {\r\n      //alert(\"Family\");\r\n      this.subscriptionType = \"Family\";\r\n      this.userType = \"Primary\";\r\n      this.authService\r\n        .updateCirclePatientAccountType(this.ptDetail.userID, \"Family\")\r\n        .subscribe(data => {\r\n          console.log(\"Upadte Status==>\", data);\r\n          this.authService\r\n          .patientdetail(this.ptDetail.userID)\r\n          .subscribe(data=>{\r\n            this.swStorage.removeStorage(this.LOGINUSER_PROFILE);\r\n            this.swStorage.setStorage(this.LOGINUSER_PROFILE, data);\r\n          })\r\n        });\r\n    }\r\n\r\n\r\n\r\n    let addCircleObj: any = {\r\n      userID: this.ptDetail.userID,\r\n      circleCode: this.circleDetail.circleObj.circleCode,\r\n      createdDateTime: new Date(),\r\n      subscribePlanId: \"1\",\r\n      status: \"Active\",\r\n      subscriptionType: this.subscriptionType,\r\n      userType: this.userType\r\n    }\r\n    let createPtChatObj: any = {\r\n      circleCode: this.circleDetail.circleObj.circleCode,\r\n      circleName: this.circleDetail.circleObj.circleName,\r\n      docUserID: this.circleDetail.circleObj.createdByUserId,\r\n      patientUserID: this.ptDetail.userID,\r\n      patientName: this.ptDetail.ptFirstName + \" \" + this.ptDetail.ptLastName,\r\n      createdByDateTime: new Date(),\r\n      videoCallLink: this.url,\r\n      status: \"Deactive\"\r\n    }\r\n    for (let dl of this.docProfileList) {\r\n      if (dl.docUserID == this.circleDetail.circleObj.createdByUserId) {\r\n        createPtChatObj.doctorName = dl.docFirstName + \" \" + dl.docLastName;\r\n        this.chatRoomName = dl.docFirstName + \" \" + dl.docLastName + \"-\" + this.ptDetail.ptFirstName + \" \" + this.ptDetail.ptLastName + \" \" + this.myRand;\r\n      }\r\n    }\r\n    createPtChatObj.chatRoomName = this.chatRoomName;\r\n    let newData = this.ref.push();\r\n    newData.set({\r\n      roomname: this.chatRoomName\r\n    });\r\n    this.currentroomKey = newData.key;\r\n    // this.ref.on('value', resp => {\r\n    //   this.rooms = [];\r\n    //   this.rooms = snapshotToArray(resp);\r\n    //   console.log(\"Rooms==>\", this.rooms);\r\n    //   for (let r of this.rooms) {\r\n    //     if (r.roomname == this.chatRoomName) {\r\n    //       this.currentroomKey = r.key;\r\n    //     }\r\n    //   }\r\n    // });  \r\n\r\n    console.log(\"addcircle\", addCircleObj);\r\n    console.log(\"createchat\", createPtChatObj);\r\n    console.log(\"Room Key\", this.currentroomKey);\r\n    setTimeout(() => {\r\n      if (this.currentroomKey != undefined) {\r\n        this.authService\r\n          .addPtToCircle(addCircleObj)\r\n          .subscribe(data => {\r\n            console.log(\"data\", data);\r\n            if (data != null) {\r\n              createPtChatObj.chatRoomKey = this.currentroomKey;\r\n              this.authService\r\n                .createPtChat(createPtChatObj)\r\n                .subscribe(data1 => {\r\n                  console.log(\"data1\", data1);\r\n                });\r\n              let chatRestrictSubscribeObj: any = {\r\n                userID: this.ptDetail.userID,\r\n                subscriptionId: this.subscriptionPlanDetails.plandetails.id,\r\n                subscriptionFromDate: this.subscriptionPlanDetails.subscriptionfromdate,\r\n                subscriptionToDate: this.subscriptionPlanDetails.subscriptionexpirydate,\r\n                paymentId: this.paymentId,\r\n                circleCode: this.circleDetail.circleObj.circleCode,\r\n                createdByUserId: this.ptDetail.userID,\r\n                createdDateTime: new Date(),\r\n                status: \"Deactive\",\r\n                chatCount: 0,\r\n                subscriptionType: this.subscriptionType\r\n              }\r\n              console.log(\"subscription detail\", this.subscriptionPlanDetails);\r\n              console.log(\"subscription detail obj\", chatRestrictSubscribeObj);\r\n              this.authService\r\n                .createChatRestriction(chatRestrictSubscribeObj)\r\n                .subscribe(data => {\r\n                  console.log(\"success restriction\", data);\r\n                });\r\n\r\n              alert(\"You have been subscribed to virtual Hospital \" + this.circleDetail.circleObj.circleName);\r\n              // let newData = this.autoRefreshFire.set({\r\n              //   trigger: true\r\n              // });\r\n              // this.router.navigate(['/subscribed-doctor-circle']);\r\n              if (this.planName == \"Plan B\") {\r\n                this.router.navigateByUrl('subscribe-family-member');\r\n              }\r\n              else {\r\n                this.router.navigateByUrl('subscribed-doctor-circle');\r\n              }\r\n\r\n            }\r\n          });\r\n      }\r\n    }, 3000);\r\n\r\n  }\r\n\r\n  pay(subscriptionData) {\r\n    var options = {\r\n      description: 'Credits towards consultation',\r\n      // image: 'https://i.imgur.com/3g7nmJC.png',\r\n      currency: 'INR',\r\n      key: 'rzp_test_SeRkqskw09t911',\r\n      subscription_id: subscriptionData.id,\r\n      name: this.ptDetail.ptFirstName + \" \" + this.ptDetail.ptLastName,\r\n      'handler': this.paymentCapture.bind(this),\r\n      prefill: {\r\n        email: 'varadhan@swasth.tech',\r\n        contact: '9884396427'\r\n      },\r\n      theme: {\r\n        color: '#F37254'\r\n      },\r\n      modal: {\r\n        ondismiss: () => { // <- Here!\r\n          //alert('dismissed')\r\n        }\r\n      }\r\n    }\r\n\r\n    var successCallback = (payment_id) => { // <- Here!\r\n      //alert('payment_id: ' + payment_id);\r\n      // this.navCtrl.push(\"ThankyouPage\",{\r\n      //         status: this.status\r\n      //     });\r\n    };\r\n\r\n    var cancelCallback = (error) => { // <- Here!\r\n      alert(error.description + ' (Error ' + error.code + ')');\r\n    };\r\n\r\n    Razorpay.open(options, successCallback, cancelCallback);\r\n  }\r\n\r\n  paymentCapture(response) {\r\n    this.paymentId = response.razorpay_payment_id;\r\n    //alert(this.paymentId);\r\n    console.log(\"payment id \" + this.paymentId);\r\n    this.subscribe();\r\n  }\r\n\r\n  random(): number {\r\n    let rand = Math.floor(Math.random() * 20000) + 1;\r\n    return rand;\r\n  }\r\n\r\n  logout() {\r\n    this.loginAuth.logout();\r\n  }\r\n}\r\n\r\nexport const snapshotToArray = snapshot => {\r\n  let returnArr = [];\r\n\r\n  snapshot.forEach(childSnapshot => {\r\n    let item = childSnapshot.val();\r\n    item.key = childSnapshot.key;\r\n    returnArr.push(item);\r\n  });\r\n\r\n  return returnArr;\r\n};\r\n"]}